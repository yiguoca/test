package main_test

import (
	"sigs.k8s.io/kustomize/api/testutils/kusttest"
	"testing"
)

func TestThycoticSSLSecretGenerator(t *testing.T) {
	th := kusttest_test.MakeEnhancedHarness(t).PrepExecPlugin("fca.autodata.net", "v1.1", "ThycoticSSLSecretGenerator")
	defer th.Reset()

	rm := th.LoadAndRunGenerator(`
apiVersion: fca.autodata.net/v1.1
kind: ThycoticSSLSecretGenerator
metadata:
  name: fcaus-wildcard
  namespace: floopy
secret: 2591`)

	th.AssertActualEqualsExpected(rm, `
apiVersion: v1
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURVRENDQWpnQ0NRQ0pPZE8vbDh5OXhEQU5CZ2txaGtpRzl3MEJBUXNGQURCcU1Rc3dDUVlEVlFRR0V3SkQKUVRFUU1BNEdBMVVFQ0F3SFQyNTBZWEpwYnpFUE1BMEdBMVVFQnd3R1RHOXVaRzl1TVJBd0RnWURWUVFLREFkRgplR0Z0Y0d4bE1SQXdEZ1lEVlFRTERBZEZlR0Z0Y0d4bE1SUXdFZ1lEVlFRRERBdGxlR0Z0Y0d4bExtTnZiVEFlCkZ3MHlNakF4TVRReU1EUTNORFZhRncwME9UQTJNREV5TURRM05EVmFNR294Q3pBSkJnTlZCQVlUQWtOQk1SQXcKRGdZRFZRUUlEQWRQYm5SaGNtbHZNUTh3RFFZRFZRUUhEQVpNYjI1a2IyNHhFREFPQmdOVkJBb01CMFY0WVcxdwpiR1V4RURBT0JnTlZCQXNNQjBWNFlXMXdiR1V4RkRBU0JnTlZCQU1NQzJWNFlXMXdiR1V1WTI5dE1JSUJJakFOCkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQTBGVWNDZi9qQTlpdWtGZ2ZScTkrOFVoUnV5SmgKajZhYk44Zk11Vms1NXgvTHZMYnJXK01IY3prQ2xvdUpJeGVTdldjbWp3Q25KYzZhWW03aUpkc2VzWGJTK29VTgpsZU5kUUhQYS9CcWt6ZHFUZk9qdzU2SFZaZUYydTZsa2ZCVWdTTGRsNjRLS1JyTGpuT2dYNFdXbm5RSGdvYlJmCmpialBMRGVNSWNncmlITURCTFJYb25aZDhORmYwTW9yWk9WMlFjN29CZjJ6eEtSaEhXT0lpYjI3K2h0NGt1ajEKazFrZ2NYQ2VvWXhzRHNTcExNZ3RwampMaHNIcG5sdm9sZllVL2VPTHlvM1dBTGhleTZVelB4UFBnckZlaDVNcAorUWdoQjBydVdBL1Q0VDZoaWEwSnZkN2g4UFF2MG1TUkVRUnZkRm5sRUlhUU1veEtyQmVVYkxzbmlRSURBUUFCCk1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQmQ1UXhKbXR3V3ViZmkwdzRZaENqR2pHZit6dHhrSXl6VWZ6SGwKZWwwdkVTWXEvYXZLT25BVXFYMk85Y0I0QTdRdFdBU08zc2E1cU1HMGo3TmJ6bU50ZDV3RmVMNWorclJOdkZWZwpLWXJZY3dUWlN1a2ZiMkxyU0Z0ZExSOG5uWklrVGpoWmF1YjFpRVJEZlBuMm9BU0dabHpWRlpJU1BxNFo5SzNiCmEvdmVXK1R2SVJnK3V0eHI0R2dSM25rQ0RMS05lMVBrVnNFdTI3cHVCYUpHd0FqYzB0SWlYT2FNTVNRQjFkcHEKTFhoaE9NR0VaQnk0TDd4OXpSYmxFRW5rUC9aNTNPdW1FWmU1QzdTK1ZUbDN6RHYwcFJmQnNiVnJWLzJYOHJodgpETzMwSndzaXIxbGFST2xWTi9VR24yNllJUlhmSmYrcVdvS2dtaGdhNGVZTkRJSkoKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBMEZVY0NmL2pBOWl1a0ZnZlJxOSs4VWhSdXlKaGo2YWJOOGZNdVZrNTV4L0x2TGJyClcrTUhjemtDbG91Skl4ZVN2V2NtandDbkpjNmFZbTdpSmRzZXNYYlMrb1VObGVOZFFIUGEvQnFremRxVGZPancKNTZIVlplRjJ1NmxrZkJVZ1NMZGw2NEtLUnJMam5PZ1g0V1dublFIZ29iUmZqYmpQTERlTUljZ3JpSE1EQkxSWApvblpkOE5GZjBNb3JaT1YyUWM3b0JmMnp4S1JoSFdPSWliMjcraHQ0a3VqMWsxa2djWENlb1l4c0RzU3BMTWd0CnBqakxoc0hwbmx2b2xmWVUvZU9MeW8zV0FMaGV5NlV6UHhQUGdyRmVoNU1wK1FnaEIwcnVXQS9UNFQ2aGlhMEoKdmQ3aDhQUXYwbVNSRVFSdmRGbmxFSWFRTW94S3JCZVViTHNuaVFJREFRQUJBb0lCQUNWOXk0ZjVKcytBWlJuUQo0Z0FFZ1NIRzAvNkxWMmRVb2taTmpJZ21pSWNSYjhiTVhGcXk1cHBUdmlWOWd2WnZ2WmFjUTVJa21lL3gyRkt5Cmhid3VUTDIvRm9UREFRamlXOXZIZmJjMHpFZkhlQmRZakZJREM3WkQ5dXdhdGR5bXFLS3Rib2dOZS9qeEpJa08KTTQzNmowbHdGdzdDdVJkMkZNSnVWS2VYc0Uzam9abU1vcDdBSU1tanpzTXd4eU5ka0JRdUcrRkg5ckhCL0lidwo5VUN3U3lvNnpidm90QXNPdUlSYnVXSjV3NDN0d0NPNFhaU2NvdWJrUG5EOUNPTUVldXZsSEZHVktFZ21KQ2FjCnVMTEIwTDMzb3llMW5MYXZ5QU5HMjRMeHZVOUZxQ2c0TEhkcHlzUWk5SFNRR3lwSGEyT0dyTjZaS3lRSUF1ekwKcEhYRVpBRUNnWUVBNi9wVnhTUy9STHoyNlk0TlliOFRTVk85eW00UlFjREJRbzVSSW43TUJCeG5hOUQxNDVkNAozTUt2ZURTMnU1ei8zZHpqeDVxcFZkdEJ4MzlSNE85SFVBaXBob2FJdW1FYS9Mak9pb1dGNSs2VFpSSUs1U0haCkVJb2wrVU5Qb0VOczhjc3Y2aGNmSExoYS83cmd3OUNPNTFLajF0MCt1MEJUUTFQWTI2MzlDa0VDZ1lFQTRnSksKS2pxZ3FoM1VvdEt6aUtneGhTWUZUbWJVQVVmUDRiZjZJSXhITXc3Q2E0S2xPOWFSa1YzVVYvOUlGRFl0NUpiYwpGQ1lxekVsem1ncWxudkRCMUJtOFFHdkw3L2RYVDAya2lJWkdFWnNrUHF2L1ljb3haTHAzYkVCRUNiN1ZwajFVCngzS0UyMGFnWWFLalNBTW1HRjV4YWFROHo1U2FDSllOSGpZbWUwa0NnWUFoQThBV09lTHNxZ2RkZTd0Umpwc1QKS2owbVlpblY2akxmcmV1YUNPVmdPZDBhVDN6blg1elFQZ2l3cDZkZExrVDU5RnFGNVpTRlo0eVhiYSsxNmFRdgpoVmE2ZEg0U25WMWFPRHpsVW5MK2xQbFlMYU1LbGFhNTBxb25hb3hzWHFLU1had1JnelNlSHdqVU9JQVR4VTBJCi9oM2dCTW92Qm52ZnNvNW5oYnNlUVFLQmdRQ3V6dHFTWXhwVnVoRDNoMFQ1MUMzSk1LazJCTzdCdHN1aGFHMTgKczBOMnlGbTBVaTUvWSt6ZnBOVlM0czdiWXpTSDgrOXhYandJR2wvaHE0NkNxdkVnbm04dTNMRzJmM2IyamJWUApLNXdTamc2d3N0UXF6UHI3VUFhQ29ncCtCeTYxRUFiODVTVEJmWlViTDNKZmhwLzJoVVh2VWVyL0c0OHdTTzhJCmlSV21rUUtCZ0FDWTNWZW5Oa2c0VzI4SnlmSmlVOXNkM3BUNTlXSmpCajlobFJ5MzBZUEsybFc0NTNrN0tIZGsKT1BqMDF6bGVjaXl0ODdRU3J3cUdpWnlNdzBMUzhUM0grSmpBMmFvcW84WUpISW9JR05weWtCclhuaFc3K1hrNQo0L0syc29xQWk3RjRRSS9ERzZob05iYmFXVTFWbFNkQzNCVVduQWZOcDhRazdCZHNQZWo0Ci0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0t
kind: Secret
metadata:
  name: fcaus-wildcard
  namespace: floopy
type: kubernetes.io/tls
`)

}
